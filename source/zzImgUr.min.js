/*! 
 * jQuery plugin zzImgUr ver 1.5 by zzbaivong
 * http://devs.forumvi.com/
 */
(function ($) {
$.fn.zzImgUr=function(v){var a=$.extend({cliendID:"",mode:"file",format:"o,",width:"100%",max:10,loadding:"http://i.imgur.com/m3NXDa6.gif",complete:"http://i.imgur.com/1uE7VEm.png",error:"http://i.imgur.com/5f7UvPx.gif",lang:{noID:"\u1ee8ng d\u1ee5ng ch\u01b0a \u0111\u0103ng k\u00fd",addImage:"Ch\u1ecdn \u1ea3nh",addURL:"Th\u00eam URL",reset:"L\u00e0m m\u1edbi",upload:"T\u1ea3i l\u00ean",choose:"\u0110\u00e3 ch\u1ecdn",waitConnect:"\u0110ang k\u1ebft n\u1ed1i...",waitUpload:"\u0110ang t\u1ea3i l\u00ean...",
noteURL:"Nh\u1eadp URL \u1ea3nh v\u00e0o \u0111\u00e2y:",errContact:'<a href="http://devs.forumvi.com/t131-jq-plugin-jquery-plugin-zzimgur#831" rel="nofollow" target="_blank">Nh\u1ea5n v\u00e0o \u0111\u00e2y</a> \u0111\u1ec3 b\u00e1o l\u1ed7i.',errURL:"URL kh\u00f4ng truy c\u1eadp \u0111\u01b0\u1ee3c.",errSize:"URL l\u1ed7i ho\u1eb7c k\u00edch th\u01b0\u1edbc qu\u00e1 nh\u1ecf.",errRepeat:"URL kh\u00f4ng h\u1ee3p l\u1ec7 ho\u1eb7c \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng."},success:function(a,
c){},input:function(a){a.click(function(){this.select()})},remove:function(a,c){}},v);return this.each(function(v,c){function w(){2<x&&$(".imgur_Zzbv-li",c).data("height",34*x).hover(function(){var b=$(this);if($(".imgur_Zzbv-progress",b).length)return!1;b.height(b.data("height"))},function(){$(this).height(68)})}function F(b,d){$(d).css("background-image","url("+a.loadding+")");var c=$(d).closest(".imgur_Zzbv-li");$.ajax({url:"https://api.imgur.com/3/image/"+b,headers:{Authorization:"Client-ID "+
a.cliendID},type:"DELETE",success:function(b){var c=[];$.each($(".imgur_Zzbv-input",$(d).parent()),function(b,a){c.push(a.value)});a.remove(c[0],c);$(d).closest(".imgur_Zzbv-li").remove();y();"0"==z.text()&&k.click()},error:function(b){A(c,b)}})}function G(b){var d=new FileReader,f=new Image;d.readAsDataURL(b);d.onload=function(d){f.src=d.target.result;f.onerror=function(){return!1};f.onload=function(){var d=this.src;if(!$(".imgur_Zzbv-image img[src='"+d+"']",c).length){var f=this.width,e=this.height,
g=b.name,H=Math.ceil(b.size/1024)+"Kb";h.append('<div class="imgur_Zzbv-li"><div class="imgur_Zzbv-image"><img src="'+d+'" /></div><div class="imgur_Zzbv-info"><a class="imgur_Zzbv-remove" href="#">Delete</a><div class="imgur_Zzbv-tip"><img src="'+a.complete+'" alt="Complete" /> '+a.lang.choose+'</div><div class="imgur_Zzbv-wrap-progress"><div class="imgur_Zzbv-progress"></div></div><div>'+g+"</div><small><strong>"+f+"x"+e+"</strong> <em>("+H+")</em></small></div></div>");w();$(".imgur_Zzbv-progress",
c).length>q&&$(".imgur_Zzbv-li:gt("+(q-1)+")",c).remove();r.text($(".imgur_Zzbv-progress",c).length)}u()}}}function B(b,d,f){var e=$(".imgur_Zzbv-li",c).eq(b);$(".imgur_Zzbv-tip",e).html('<img src="'+a.loadding+'" alt="loading..." /> <span>'+a.lang.waitConnect+"</span>");$.ajax({url:"https://api.imgur.com/3/image",xhr:function(){var b=new window.XMLHttpRequest;b.upload.addEventListener("progress",function(b){b.lengthComputable&&(b=b.loaded/b.total*100+"%",$(".imgur_Zzbv-tip span",e).text(a.lang.waitUpload),
$(".imgur_Zzbv-progress",e).animate({width:b}))},!1);return b},method:"POST",headers:{Authorization:"Client-ID "+a.cliendID},data:{image:d,type:f},success:function(b){$(".imgur_Zzbv-info",e).html(I(b,a.format.split(",")));a.input($(".imgur_Zzbv-input",e));C();e.addClass("imgur_Zzbv-success");setTimeout(function(){e.removeClass("imgur_Zzbv-success")},300);l.html('<img src="'+a.complete+'" alt="Complete" />')},error:function(b){l.html('<img src="'+a.error+'" alt="Error" />');A(e,b);C()}})}function C(){y();
0===$(".imgur_Zzbv-progress",c).length&&k.fadeIn()}function y(){z.text($(".imgur_Zzbv-dl",c).length/a.format.split(",").length)}function A(b,d){$(".imgur_Zzbv-info",b).html('<div class=".imgur_Zzbv-dl"><div class=".imgur_Zzbv-dt"></div><div class=".imgur_Zzbv-dd" style="margin-left: 0!important; color: red">'+d.statusText+'</div></div><div class=".imgur_Zzbv-dl"><div class=".imgur_Zzbv-dt"></div><div class=".imgur_Zzbv-dd" style="margin-left: 0!important">'+a.lang.errContact+"</div></div>")}function J(b,
d){var a=b.data.link;return null===d||""===d?a:"o"===d?"[img]"+a+"[/img]":"[url="+a+"][img]http://i.imgur.com/"+b.data.id+d+"."+b.data.type.split("/")[1]+"[/img][/url]"}function K(b){var a="";switch(b){case "o":a="Original";break;case "s":a="Small Square";break;case "b":a="Big Square";break;case "t":a="Small Thumb";break;case "m":a="Medium Thumb";break;case "l":a="Large Thumb";break;case "h":a="Huge Thumb";break;case "c":a="Custom";break;default:a="Direct Link"}return a}function I(b,c){var f="",e=
[],g="",h="";$.each(c,function(a,c){var d=c.match(/\{(o|s|b|t|m|l|h)\}/gi);if(null===d)g=c,h=J(b,c);else{var k=c;$.each(d,function(a,c){g=/o|s|b|t|m|l|h/.exec(c)[0];k=k.replace(c,"http://i.imgur.com/"+b.data.id+g+"."+b.data.type.split("/")[1])});g="c";h=k}e.push(h);d='<a class="imgur_Zzbv-delete" data-delete="'+b.data.deletehash+'" href="#" target="_blank">Delete</a>';0!==a&&(d="");f+=d+'<div class="imgur_Zzbv-dl"><div class="imgur_Zzbv-dt">'+K(g)+':</div><div class="imgur_Zzbv-dd"><input type="text" class="imgur_Zzbv-input" value="'+
h+'" readonly="readonly" /></div></div>'});a.success(e[0],e);return f}function u(){m.add(s).fadeIn()}var n='multiple="multiple"',q=a.max;1===q&&(n="");$(this,c).html('<div class="imgur_Zzbv" style="width: '+a.width+'"> <div class="imgur_Zzbv-control"> <div class="imgur_Zzbv-mode"></div> <div class="imgur_Zzbv-status"> <img src="'+a.loadding+'" alt="loading..." /> </div> <div class="imgur_Zzbv-upload-computer imgur_Zzbv-add"> <div class="imgur_Zzbv-iconSelect"></div> <div class="imgur_Zzbv-textSelect">'+
a.lang.addImage+'</div> <input type="file" class="imgur_Zzbv-choose" '+n+' /> </div> <div class="imgur_Zzbv-upload-URL imgur_Zzbv-add"> <div class="imgur_Zzbv-iconSelect"></div> <div class="imgur_Zzbv-textSelect">'+a.lang.addURL+'</div> </div> <div class="imgur_Zzbv-length"> <span class="imgur_Zzbv-complete">0</span> / <span class="imgur_Zzbv-selected">0</span> </div> <div class="imgur_Zzbv-button"> <div class="imgur_Zzbv-reset">'+a.lang.reset+'</div> <div class="imgur_Zzbv-upload">'+a.lang.upload+
'</div> </div> <a class="imgur_Zzbv-devs-icon" target="_blank" href="http://devs.forumvi.com/"> <img alt="devs icon" src="http://i56.servimg.com/u/f56/18/59/49/93/l111.png" /> </a> </div> <div class="imgur_Zzbv-preview"> <div class="imgur_Zzbv-list"></div> </div> </div>');var n=$(".imgur_Zzbv-control",c),g=$(".imgur_Zzbv-mode",c),l=$(".imgur_Zzbv-status",c),D=$(".imgur_Zzbv-upload-computer",c),t=$(".imgur_Zzbv-choose",c),p=$(".imgur_Zzbv-upload-URL",c),E=$(".imgur_Zzbv-add",c),s=$(".imgur_Zzbv-length",
c),r=$(".imgur_Zzbv-selected",c),z=$(".imgur_Zzbv-complete",c),k=$(".imgur_Zzbv-reset",c),m=$(".imgur_Zzbv-upload",c),h=$(".imgur_Zzbv-list",c),x=a.format.split(",").length;if(!/[a-z0-9]{15}/.test(a.cliendID))return n.html('<div class="imgur_Zzbv-status" style="display: block;"> <img src="'+a.error+'" alt="Error" /> </div><div style="text-align: center;">'+a.lang.noID+': <span style="color: red;">cliendID</span><a class="imgur_Zzbv-devs-icon" target="_blank" href="http://devs.forumvi.com/"> <img alt="devs icon" src="http://i56.servimg.com/u/f56/18/59/49/93/l111.png" /> </a></div>'),
!1;"url"==a.mode&&(g.addClass("imgur_Zzbv-zzURL"),E.toggle());n.on("change",".imgur_Zzbv-choose",function(b){if((b=this.files)&&b[0])for(var d=0;d<b.length;d++)G(b[d],c,a)});m.click(function(){if(g.hasClass("imgur_Zzbv-zzURL")){$(".imgur_Zzbv-imageURL:not('.imgur_Zzbv-ok')",c).closest(".imgur_Zzbv-li").remove();r.text($(".imgur_Zzbv-imageURL",c).length);if(h.is(":empty"))return s.add(m).fadeOut(),!1;$(".imgur_Zzbv-imageURL",c).each(function(a){B(a,this.value,"URL")})}else $(".imgur_Zzbv-image img",
c).each(function(a){B(a,this.src.replace(/data:image\/.+;base64\,/,""),"base64")});m.add(g).add(E).add(".imgur_Zzbv-remove",c).fadeOut();l.fadeIn()});k.click(function(){g.hasClass("imgur_Zzbv-zzURL")?(p.show(),D.hide()):(p.hide(),D.show(),t.replaceWith(t.clone()));h.empty();$("span",s).text(0);l.html('<img src="'+a.loadding+'" alt="loading..." />');k.add(m).add(l).add(s).fadeOut();g.fadeIn()});h.on("click",".imgur_Zzbv-delete",function(a){a.preventDefault();F($(this).data("delete"),this)});h.on("click",
".imgur_Zzbv-remove",function(a){a.preventDefault();$(this).closest(".imgur_Zzbv-li").remove();a=$(".imgur_Zzbv-progress",c).length;r.text(a);"0"==a&&k.click();t.replaceWith(t.clone());10>$(".imgur_Zzbv-imageURL",c).length&&p.fadeIn()});p.click(function(){h.prepend('<div class="imgur_Zzbv-li"><div class="imgur_Zzbv-image"></div><div class="imgur_Zzbv-info"><a class="imgur_Zzbv-remove" href="#">Delete</a><div class="imgur_Zzbv-tip">'+a.lang.noteURL+'</div><div class="imgur_Zzbv-wrap-progress"><div class="imgur_Zzbv-progress"></div></div><input class="imgur_Zzbv-imageURL" type="text" /></div></div>');
w();u();r.text($(".imgur_Zzbv-progress",c).length);$(".imgur_Zzbv-imageURL",c).length>=q&&p.hide()});h.on("input",".imgur_Zzbv-imageURL",function(){var b=this.value,d=$(this),f=d.prev().prev();if(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([[^\\s]\/]*)*\/?.+\.(jpg|png|gif|jpeg|bmp|apng|tiff|xcf)$/i.test(b)&&!$(".imgur_Zzbv-image img[src='"+b+"']",c).length){d.parent().prev().html('<img src="'+b+'" />');f.html('<img src="'+a.complete+'" alt="Complete" /> '+b.match(/\w+\.(jpg|png|gif|jpeg|bmp|apng|tiff|xcf)/i)[0]);
d.addClass("imgur_Zzbv-ok");var e=d.parent().prev().find("img");e.error(function(){f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errURL+"</span>");d.removeClass("imgur_Zzbv-ok")});e.load(function(){1==e.width()&&1==e.height()&&(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errSize+"</span>"),d.removeClass("imgur_Zzbv-ok"))});u(c)}else null===b||""===b?(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+
'" alt="Error" /> '+a.lang.noteURL+"</span>"),d.removeClass("imgur_Zzbv-ok"),d.parent().prev().empty()):(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errRepeat+"</span>"),d.removeClass("imgur_Zzbv-ok"))});g.click(function(){g.toggleClass("imgur_Zzbv-zzURL");k.click()})})};
}(jQuery));
