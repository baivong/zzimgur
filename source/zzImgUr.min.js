/*! 
 * jQuery plugin zzImgUr ver 1.5 by zzbaivong
 * http://devs.forumvi.com/
 */ 
(function ($) {
$.fn.zzImgUr=function(v){var a=$.extend({cliendID:"",mode:"file",format:"o,",width:"100%",max:10,loadding:"http://i.imgur.com/m3NXDa6.gif",complete:"http://i.imgur.com/1uE7VEm.png",error:"http://i.imgur.com/5f7UvPx.gif",lang:{noID:"\u1ee8ng d\u1ee5ng ch\u01b0a \u0111\u0103ng k\u00fd",addImage:"Ch\u1ecdn \u1ea3nh",addURL:"Th\u00eam URL",reset:"L\u00e0m m\u1edbi",upload:"T\u1ea3i l\u00ean",choose:"\u0110\u00e3 ch\u1ecdn",waitConnect:"\u0110ang k\u1ebft n\u1ed1i...",waitUpload:"\u0110ang t\u1ea3i l\u00ean...",
noteURL:"Nh\u1eadp URL \u1ea3nh v\u00e0o \u0111\u00e2y:",errContact:'<a href="http://devs.forumvi.com/t131-jq-plugin-jquery-plugin-zzimgur#831" rel="nofollow" target="_blank">Nh\u1ea5n v\u00e0o \u0111\u00e2y</a> \u0111\u1ec3 b\u00e1o l\u1ed7i.',errURL:"URL kh\u00f4ng truy c\u1eadp \u0111\u01b0\u1ee3c.",errSize:"URL l\u1ed7i ho\u1eb7c k\u00edch th\u01b0\u1edbc qu\u00e1 nh\u1ecf.",errRepeat:"URL kh\u00f4ng h\u1ee3p l\u1ec7 ho\u1eb7c \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng."},success:function(a){$("textarea").val($("textarea").val()+
a[0])},input:function(a){a.click(function(){this.select()})},remove:function(a){$("textarea").val($("textarea").val().replace(a[0],""))}},v);return this.each(function(v,b){function w(){2<x&&$(".imgur_Zzbv-li",b).data("height",34*x).hover(function(){var c=$(this);if($(".imgur_Zzbv-progress",c).length)return!1;c.height(c.data("height"))},function(){$(this).height(68)})}function F(c,d){$(d).css("background-image","url("+a.loadding+")");var b=$(d).closest(".imgur_Zzbv-li");$.ajax({url:"https://api.imgur.com/3/image/"+
c,headers:{Authorization:"Client-ID "+a.cliendID},type:"DELETE",success:function(c){var b=[];$.each($(".imgur_Zzbv-input",$(d).parent()),function(c,a){b.push(a.value)});a.remove(b);$(d).closest(".imgur_Zzbv-li").remove();y();"0"==z.text()&&k.click()},error:function(c){A(b,c)}})}function G(c){var d=new FileReader,f=new Image;d.readAsDataURL(c);d.onload=function(d){f.src=d.target.result;f.onerror=function(){return!1};f.onload=function(){var d=this.src;if(!$(".imgur_Zzbv-image img[src='"+d+"']",b).length){var f=
this.width,e=this.height,g=c.name,H=Math.ceil(c.size/1024)+"Kb";h.append('<div class="imgur_Zzbv-li"><div class="imgur_Zzbv-image"><img src="'+d+'" /></div><div class="imgur_Zzbv-info"><a class="imgur_Zzbv-remove" href="#">Delete</a><div class="imgur_Zzbv-tip"><img src="'+a.complete+'" alt="Complete" /> '+a.lang.choose+'</div><div class="imgur_Zzbv-wrap-progress"><div class="imgur_Zzbv-progress"></div></div><div>'+g+"</div><small><strong>"+f+"x"+e+"</strong> <em>("+H+")</em></small></div></div>");
w();$(".imgur_Zzbv-progress",b).length>q&&$(".imgur_Zzbv-li:gt("+(q-1)+")",b).remove();r.text($(".imgur_Zzbv-progress",b).length)}u()}}}function B(c,d,f){var e=$(".imgur_Zzbv-li",b).eq(c);$(".imgur_Zzbv-tip",e).html('<img src="'+a.loadding+'" alt="loading..." /> <span>'+a.lang.waitConnect+"</span>");$.ajax({url:"https://api.imgur.com/3/image",xhr:function(){var c=new window.XMLHttpRequest;c.upload.addEventListener("progress",function(c){c.lengthComputable&&(c=c.loaded/c.total*100+"%",$(".imgur_Zzbv-tip span",
e).text(a.lang.waitUpload),$(".imgur_Zzbv-progress",e).animate({width:c}))},!1);return c},method:"POST",headers:{Authorization:"Client-ID "+a.cliendID},data:{image:d,type:f},success:function(c){$(".imgur_Zzbv-info",e).html(I(c,a.format.split(",")));a.input($(".imgur_Zzbv-input",e));C();e.addClass("imgur_Zzbv-success");setTimeout(function(){e.removeClass("imgur_Zzbv-success")},300);l.html('<img src="'+a.complete+'" alt="Complete" />')},error:function(c){l.html('<img src="'+a.error+'" alt="Error" />');
A(e,c);C()}})}function C(){y();0===$(".imgur_Zzbv-progress",b).length&&k.fadeIn()}function y(){z.text($(".imgur_Zzbv-dl",b).length/a.format.split(",").length)}function A(c,d){$(".imgur_Zzbv-info",c).html('<div class=".imgur_Zzbv-dl"><div class=".imgur_Zzbv-dt"></div><div class=".imgur_Zzbv-dd" style="margin-left: 0!important; color: red">'+d.statusText+'</div></div><div class=".imgur_Zzbv-dl"><div class=".imgur_Zzbv-dt"></div><div class=".imgur_Zzbv-dd" style="margin-left: 0!important">'+a.lang.errContact+
"</div></div>")}function J(c,a){var b=c.data.link;return null===a||""===a?b:"o"===a?"[img]"+b+"[/img]":"[url="+b+"][img]http://i.imgur.com/"+c.data.id+a+"."+c.data.type.split("/")[1]+"[/img][/url]"}function K(c){var a="";switch(c){case "o":a="Original";break;case "s":a="Small Square";break;case "b":a="Big Square";break;case "t":a="Small Thumb";break;case "m":a="Medium Thumb";break;case "l":a="Large Thumb";break;case "h":a="Huge Thumb";break;case "c":a="Custom";break;default:a="Direct Link"}return a}
function I(c,b){var f="",e=[],g="",h="";$.each(b,function(a,b){var d=b.match(/\{(o|s|b|t|m|l|h)\}/gi);if(null===d)g=b,h=J(c,b);else{var k=b;$.each(d,function(a,b){g=/o|s|b|t|m|l|h/.exec(b)[0];k=k.replace(b,"http://i.imgur.com/"+c.data.id+g+"."+c.data.type.split("/")[1])});g="c";h=k}e.push(h);d='<a class="imgur_Zzbv-delete" data-delete="'+c.data.deletehash+'" href="#" target="_blank">Delete</a>';0!==a&&(d="");f+=d+'<div class="imgur_Zzbv-dl"><div class="imgur_Zzbv-dt">'+K(g)+':</div><div class="imgur_Zzbv-dd"><input type="text" class="imgur_Zzbv-input" value="'+
h+'" readonly="readonly" /></div></div>'});a.success(e);return f}function u(){m.add(s).fadeIn()}var n='multiple="multiple"',q=a.max;1===q&&(n="");$(this,b).html('<div class="imgur_Zzbv" style="width: '+a.width+'"> <div class="imgur_Zzbv-control"> <div class="imgur_Zzbv-mode"></div> <div class="imgur_Zzbv-status"> <img src="'+a.loadding+'" alt="loading..." /> </div> <div class="imgur_Zzbv-upload-computer imgur_Zzbv-add"> <div class="imgur_Zzbv-iconSelect"></div> <div class="imgur_Zzbv-textSelect">'+
a.lang.addImage+'</div> <input type="file" class="imgur_Zzbv-choose" '+n+' /> </div> <div class="imgur_Zzbv-upload-URL imgur_Zzbv-add"> <div class="imgur_Zzbv-iconSelect"></div> <div class="imgur_Zzbv-textSelect">'+a.lang.addURL+'</div> </div> <div class="imgur_Zzbv-length"> <span class="imgur_Zzbv-complete">0</span> / <span class="imgur_Zzbv-selected">0</span> </div> <div class="imgur_Zzbv-button"> <div class="imgur_Zzbv-reset">'+a.lang.reset+'</div> <div class="imgur_Zzbv-upload">'+a.lang.upload+
'</div> </div> <a class="imgur_Zzbv-devs-icon" target="_blank" href="http://devs.forumvi.com/"> <img alt="devs icon" src="http://i56.servimg.com/u/f56/18/59/49/93/l111.png" /> </a> </div> <div class="imgur_Zzbv-preview"> <div class="imgur_Zzbv-list"></div> </div> </div>');var n=$(".imgur_Zzbv-control",b),g=$(".imgur_Zzbv-mode",b),l=$(".imgur_Zzbv-status",b),D=$(".imgur_Zzbv-upload-computer",b),t=$(".imgur_Zzbv-choose",b),p=$(".imgur_Zzbv-upload-URL",b),E=$(".imgur_Zzbv-add",b),s=$(".imgur_Zzbv-length",
b),r=$(".imgur_Zzbv-selected",b),z=$(".imgur_Zzbv-complete",b),k=$(".imgur_Zzbv-reset",b),m=$(".imgur_Zzbv-upload",b),h=$(".imgur_Zzbv-list",b),x=a.format.split(",").length;if(!/[a-z0-9]{15}/.test(a.cliendID))return n.html('<div class="imgur_Zzbv-status" style="display: block;"> <img src="'+a.error+'" alt="Error" /> </div><div style="text-align: center;">'+a.lang.noID+': <span style="color: red;">cliendID</span><a class="imgur_Zzbv-devs-icon" target="_blank" href="http://devs.forumvi.com/"> <img alt="devs icon" src="http://i56.servimg.com/u/f56/18/59/49/93/l111.png" /> </a></div>'),
!1;"url"==a.mode&&(g.addClass("imgur_Zzbv-zzURL"),E.toggle());n.on("change",".imgur_Zzbv-choose",function(c){if((c=this.files)&&c[0])for(var d=0;d<c.length;d++)G(c[d],b,a)});m.click(function(){if(g.hasClass("imgur_Zzbv-zzURL")){$(".imgur_Zzbv-imageURL:not('.imgur_Zzbv-ok')",b).closest(".imgur_Zzbv-li").remove();r.text($(".imgur_Zzbv-imageURL",b).length);if(h.is(":empty"))return s.add(m).fadeOut(),!1;$(".imgur_Zzbv-imageURL",b).each(function(a){B(a,this.value,"URL")})}else $(".imgur_Zzbv-image img",
b).each(function(a){B(a,this.src.replace(/data:image\/.+;base64\,/,""),"base64")});m.add(g).add(E).add(".imgur_Zzbv-remove",b).fadeOut();l.fadeIn()});k.click(function(){g.hasClass("imgur_Zzbv-zzURL")?(p.show(),D.hide()):(p.hide(),D.show(),t.replaceWith(t.clone()));h.empty();$("span",s).text(0);l.html('<img src="'+a.loadding+'" alt="loading..." />');k.add(m).add(l).add(s).fadeOut();g.fadeIn()});h.on("click",".imgur_Zzbv-delete",function(a){a.preventDefault();F($(this).data("delete"),this)});h.on("click",
".imgur_Zzbv-remove",function(a){a.preventDefault();$(this).closest(".imgur_Zzbv-li").remove();a=$(".imgur_Zzbv-progress",b).length;r.text(a);"0"==a&&k.click();t.replaceWith(t.clone());10>$(".imgur_Zzbv-imageURL",b).length&&p.fadeIn()});p.click(function(){h.prepend('<div class="imgur_Zzbv-li"><div class="imgur_Zzbv-image"></div><div class="imgur_Zzbv-info"><a class="imgur_Zzbv-remove" href="#">Delete</a><div class="imgur_Zzbv-tip">'+a.lang.noteURL+'</div><div class="imgur_Zzbv-wrap-progress"><div class="imgur_Zzbv-progress"></div></div><input class="imgur_Zzbv-imageURL" type="text" /></div></div>');
w();u();r.text($(".imgur_Zzbv-progress",b).length);$(".imgur_Zzbv-imageURL",b).length>=q&&p.hide()});h.on("input",".imgur_Zzbv-imageURL",function(){var c=this.value,d=$(this),f=d.prev().prev();if(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([[^\\s]\/]*)*\/?.+\.(jpg|png|gif|jpeg|bmp|apng|tiff|xcf)$/i.test(c)&&!$(".imgur_Zzbv-image img[src='"+c+"']",b).length){d.parent().prev().html('<img src="'+c+'" />');f.html('<img src="'+a.complete+'" alt="Complete" /> '+c.match(/\w+\.(jpg|png|gif|jpeg|bmp|apng|tiff|xcf)/i)[0]);
d.addClass("imgur_Zzbv-ok");var e=d.parent().prev().find("img");e.error(function(){f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errURL+"</span>");d.removeClass("imgur_Zzbv-ok")});e.load(function(){1==e.width()&&1==e.height()&&(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errSize+"</span>"),d.removeClass("imgur_Zzbv-ok"))});u(b)}else null===c||""===c?(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+
'" alt="Error" /> '+a.lang.noteURL+"</span>"),d.removeClass("imgur_Zzbv-ok"),d.parent().prev().empty()):(f.html('<span class="imgur_Zzbv-errorURL"><img src="'+a.error+'" alt="Error" /> '+a.lang.errRepeat+"</span>"),d.removeClass("imgur_Zzbv-ok"))});g.click(function(){g.toggleClass("imgur_Zzbv-zzURL");k.click()})})};
}(jQuery));
